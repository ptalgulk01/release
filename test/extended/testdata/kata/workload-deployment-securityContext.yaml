apiVersion: template.openshift.io/v1
kind: Template
metadata:
  name: deployment-template
objects:
  - apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: "${NAME}"
      namespace: "${NAMESPACE}"
    spec:
      replicas: ${{REPLICAS}}
      selector:
        matchLabels:
          app: httpd-app
      template:
        metadata:
          labels:
            app: httpd-app
        spec:
          replicas: 1
          runtimeClassName: "${RUNTIMECLASSNAME}"
          containers:
            - image: "${IMAGE}"
              imagePullPolicy: IfNotPresent
              name: "${NAME}"
              ports:
                - containerPort: ${{PORT}}
              securityContext:
                runAsNonRoot: true
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                seccompProfile:
                  type: RuntimeDefault

parameters:
  - name: NAME
    value: "none"
  - name: REPLICAS
    value: "3"
  - name: RUNTIMECLASSNAME
    value: "kata"
  - name: NAMESPACE
  - name: IMAGE
    value: "registry.redhat.io/rhscl/httpd-24-rhel7"
  - name: PORT
    value: "8080"
