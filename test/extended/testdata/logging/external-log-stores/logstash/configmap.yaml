kind: Template
apiVersion: template.openshift.io/v1
metadata:
  name: external-log-store-template
objects:
- apiVersion: v1
  data:
    logstash.conf: |
      input {
        tcp {
          codec => fluent { nanosecond_precision => true } port => 24114
        }
      }
      filter {
      }
      output {
        if [log_type] == "application" {
          file { path => "/usr/share/logstash/data/app.log" }
        }
        else if [log_type] == "infrastructure" {
          file { path => "/usr/share/logstash/data/infra.log" }
        }
        else {
          file { path => "/usr/share/logstash/data/audit.log" }
        }
      }
    logstash.yml: |
      http.host: "0.0.0.0"
      xpack.monitoring.enabled: false
  kind: ConfigMap
  metadata:
    name: ${NAME}
    namespace: ${NAMESPACE}
parameters:
- name: NAME
  value: "logstash"
- name: NAMESPACE
  value: "logstash"
