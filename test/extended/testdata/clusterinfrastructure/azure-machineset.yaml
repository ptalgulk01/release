apiVersion: template.openshift.io/v1
kind: Template
metadata:
  name: azure-machineset-template
objects:
  - apiVersion: machine.openshift.io/v1beta1
    kind: MachineSet
    metadata:
      labels:
        machine.openshift.io/cluster-api-cluster: ${CLUSTERID}
        machine.openshift.io/cluster-api-machine-role: worker
        machine.openshift.io/cluster-api-machine-type: worker
      name: ${NAME}
      namespace: openshift-machine-api
    spec:
      replicas: ${{REPLICAS}}
      selector:
        matchLabels:
          machine.openshift.io/cluster-api-cluster: ${CLUSTERID}
          machine.openshift.io/cluster-api-machineset: ${NAME}
      template:
        metadata:
          labels:
            machine.openshift.io/cluster-api-cluster: ${CLUSTERID}
            machine.openshift.io/cluster-api-machine-role: worker
            machine.openshift.io/cluster-api-machine-type: worker
            machine.openshift.io/cluster-api-machineset: ${NAME}
        spec:
          metadata: {}
          taints:
            - effect: "NoSchedule"
              key: "mapi"
              value: "mapi_test"
          providerSpec:
            value:
              apiVersion: azureproviderconfig.openshift.io/v1beta1
              credentialsSecret:
                name: azure-cloud-credentials
                namespace: openshift-machine-api
              image:
                offer: ""
                publisher: ""
                resourceID: /resourceGroups/${CLUSTERID}-rg/providers/Microsoft.Compute/images/${CLUSTERID}
                sku: ""
                version: ""
              kind: AzureMachineProviderSpec
              location: ${REGION}
              managedIdentity: ${CLUSTERID}-identity
              metadata:
                creationTimestamp: null
              networkResourceGroup: ${CLUSTERID}-rg
              osDisk:
                diskSizeGB: 128
                managedDisk:
                  storageAccountType: Premium_LRS
                osType: Linux
              publicIP: false
              publicLoadBalancer: ${CLUSTERID}
              resourceGroup: ${CLUSTERID}-rg
              subnet: ${CLUSTERID}-worker-subnet
              userDataSecret:
                name: worker-user-data
              vmSize: Standard_D4s_v3
              vnet: ${CLUSTERID}-vnet
              zone: ""
parameters:
- name: NAME
- name: CLUSTERID
- name: REPLICAS
- name: REGION
